{
    "events": [
        {
            "timestamp": "2026-02-27T00:07:08.341000-05:00",
            "type": "ExecutionStarted",
            "id": 1,
            "previousEventId": 0,
            "executionStartedEventDetails": {
                "input": "{\n  \"expected_account_id\": \"048622080012\",\n  \"region\": \"us-east-1\",\n  \"project\": \"signalcraft\",\n  \"publish_bucket\": \"jobintel-prod1\",\n  \"publish_prefix\": \"jobintel\",\n  \"backup_bucket\": \"jobintel-prod1\",\n  \"backup_uri\": \"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\n  \"backup_required_keys\": [\n    \"metadata.json\",\n    \"state.tar.zst\",\n    \"manifests.tar.zst\"\n  ],\n  \"receipt_bucket\": \"jobintel-prod1\",\n  \"receipt_prefix\": \"jobintel/dr-orchestrator/receipts\",\n  \"notification_topic_arn\": \"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\n  \"provider\": \"openai\",\n  \"profile\": \"cs\",\n  \"expected_marker_file\": \"openai_top.cs.md\",\n  \"max_freshness_hours\": 6,\n  \"metric_namespace\": \"SignalCraft/DR\",\n  \"dr_runner_name\": \"jobintel-dr-runner\",\n  \"dr_vpc_id\": \"vpc-4362fc3e\",\n  \"dr_subnet_id\": \"subnet-11001d5c\",\n  \"dr_allowed_cidr\": \"10.0.0.0/8\",\n  \"dr_key_name\": \"\",\n  \"dr_instance_type\": \"t4g.small\",\n  \"dr_ami_id\": \"\",\n  \"namespace\": \"jobintel\",\n  \"validate_timeout_seconds\": 300,\n  \"force_run\": true\n}",
                "inputDetails": {
                    "truncated": false
                },
                "roleArn": "arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-sfn-role"
            }
        },
        {
            "timestamp": "2026-02-27T00:07:08.373000-05:00",
            "type": "PassStateEntered",
            "id": 2,
            "previousEventId": 0,
            "stateEnteredEventDetails": {
                "name": "SetPhaseCheckHealth",
                "input": "{\n  \"expected_account_id\": \"048622080012\",\n  \"region\": \"us-east-1\",\n  \"project\": \"signalcraft\",\n  \"publish_bucket\": \"jobintel-prod1\",\n  \"publish_prefix\": \"jobintel\",\n  \"backup_bucket\": \"jobintel-prod1\",\n  \"backup_uri\": \"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\n  \"backup_required_keys\": [\n    \"metadata.json\",\n    \"state.tar.zst\",\n    \"manifests.tar.zst\"\n  ],\n  \"receipt_bucket\": \"jobintel-prod1\",\n  \"receipt_prefix\": \"jobintel/dr-orchestrator/receipts\",\n  \"notification_topic_arn\": \"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\n  \"provider\": \"openai\",\n  \"profile\": \"cs\",\n  \"expected_marker_file\": \"openai_top.cs.md\",\n  \"max_freshness_hours\": 6,\n  \"metric_namespace\": \"SignalCraft/DR\",\n  \"dr_runner_name\": \"jobintel-dr-runner\",\n  \"dr_vpc_id\": \"vpc-4362fc3e\",\n  \"dr_subnet_id\": \"subnet-11001d5c\",\n  \"dr_allowed_cidr\": \"10.0.0.0/8\",\n  \"dr_key_name\": \"\",\n  \"dr_instance_type\": \"t4g.small\",\n  \"dr_ami_id\": \"\",\n  \"namespace\": \"jobintel\",\n  \"validate_timeout_seconds\": 300,\n  \"force_run\": true\n}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:07:08.373000-05:00",
            "type": "PassStateExited",
            "id": 3,
            "previousEventId": 2,
            "stateExitedEventDetails": {
                "name": "SetPhaseCheckHealth",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"check_health\"}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:07:08.373000-05:00",
            "type": "TaskStateEntered",
            "id": 4,
            "previousEventId": 3,
            "stateEnteredEventDetails": {
                "name": "CheckHealth",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"check_health\"}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:07:08.373000-05:00",
            "type": "TaskScheduled",
            "id": 5,
            "previousEventId": 4,
            "taskScheduledEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke",
                "region": "us-east-1",
                "parameters": "{\"FunctionName\":\"arn:aws:lambda:us-east-1:048622080012:function:signalcraft-dr-orchestrator-runner\",\"Payload\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"}}"
            }
        },
        {
            "timestamp": "2026-02-27T00:07:08.437000-05:00",
            "type": "TaskStarted",
            "id": 6,
            "previousEventId": 5,
            "taskStartedEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke"
            }
        },
        {
            "timestamp": "2026-02-27T00:07:11.001000-05:00",
            "type": "TaskSucceeded",
            "id": 7,
            "previousEventId": 6,
            "taskSucceededEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke",
                "output": "{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"ok\":true,\"phase_name\":\"check_health\",\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\",\"failure_reason\":\"\"},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"22dfdab0-b560-40c6-bdea-4fac9e4345e4\"],\"Content-Length\":[\"1144\"],\"Date\":[\"Fri, 27 Feb 2026 05:07:10 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-69a1267c-28ccddf17bf3587d595c4285;Parent=7dbf0bfd7b9f2b6b;Sampled=0;Lineage=1:ba18b611:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"1144\",\"Content-Type\":\"application/json\",\"Date\":\"Fri, 27 Feb 2026 05:07:10 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"22dfdab0-b560-40c6-bdea-4fac9e4345e4\",\"X-Amzn-Trace-Id\":\"Root=1-69a1267c-28ccddf17bf3587d595c4285;Parent=7dbf0bfd7b9f2b6b;Sampled=0;Lineage=1:ba18b611:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"22dfdab0-b560-40c6-bdea-4fac9e4345e4\"},\"StatusCode\":200}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:07:11.024000-05:00",
            "type": "TaskStateExited",
            "id": 8,
            "previousEventId": 7,
            "stateExitedEventDetails": {
                "name": "CheckHealth",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"check_health\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"}}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:07:11.024000-05:00",
            "type": "ChoiceStateEntered",
            "id": 9,
            "previousEventId": 8,
            "stateEnteredEventDetails": {
                "name": "ShouldRunDR",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"check_health\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"}}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:07:11.024000-05:00",
            "type": "ChoiceStateExited",
            "id": 10,
            "previousEventId": 9,
            "stateExitedEventDetails": {
                "name": "ShouldRunDR",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"check_health\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"}}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:07:11.024000-05:00",
            "type": "PassStateEntered",
            "id": 11,
            "previousEventId": 10,
            "stateEnteredEventDetails": {
                "name": "SetPhaseBringup",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"check_health\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"}}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:07:11.024000-05:00",
            "type": "PassStateExited",
            "id": 12,
            "previousEventId": 11,
            "stateExitedEventDetails": {
                "name": "SetPhaseBringup",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"bringup\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"}}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:07:11.024000-05:00",
            "type": "TaskStateEntered",
            "id": 13,
            "previousEventId": 12,
            "stateEnteredEventDetails": {
                "name": "BringupInfra",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"bringup\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"}}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:07:11.024000-05:00",
            "type": "TaskScheduled",
            "id": 14,
            "previousEventId": 13,
            "taskScheduledEventDetails": {
                "resourceType": "codebuild",
                "resource": "startBuild.sync",
                "region": "us-east-1",
                "parameters": "{\"EnvironmentVariablesOverride\":[{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\"}"
            }
        },
        {
            "timestamp": "2026-02-27T00:07:11.099000-05:00",
            "type": "TaskStarted",
            "id": 15,
            "previousEventId": 14,
            "taskStartedEventDetails": {
                "resourceType": "codebuild",
                "resource": "startBuild.sync"
            }
        },
        {
            "timestamp": "2026-02-27T00:07:11.335000-05:00",
            "type": "TaskSubmitted",
            "id": 16,
            "previousEventId": 15,
            "taskSubmittedEventDetails": {
                "resourceType": "codebuild",
                "resource": "startBuild.sync",
                "output": "{\"Build\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":false,\"BuildNumber\":9,\"BuildStatus\":\"IN_PROGRESS\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"QUEUED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:null:log-stream:null\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"}},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"x-amzn-RequestId\":[\"c1667292-cb84-46df-bf08-440edec0860a\"],\"Content-Length\":[\"8186\"],\"Date\":[\"Fri, 27 Feb 2026 05:07:11 GMT\"],\"Content-Type\":[\"application/x-amz-json-1.1\"]},\"HttpHeaders\":{\"Content-Length\":\"8186\",\"Content-Type\":\"application/x-amz-json-1.1\",\"Date\":\"Fri, 27 Feb 2026 05:07:11 GMT\",\"x-amzn-RequestId\":\"c1667292-cb84-46df-bf08-440edec0860a\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"c1667292-cb84-46df-bf08-440edec0860a\"}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:39.458000-05:00",
            "type": "TaskSucceeded",
            "id": 17,
            "previousEventId": 16,
            "taskSucceededEventDetails": {
                "resourceType": "codebuild",
                "resource": "startBuild.sync",
                "output": "{\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"x-amzn-RequestId\":[\"87724547-631e-4bec-8815-5dac6073fe53\"],\"Content-Length\":[\"10115\"],\"Date\":[\"Fri, 27 Feb 2026 05:08:39 GMT\"],\"Content-Type\":[\"application/x-amz-json-1.1\"]},\"HttpHeaders\":{\"Content-Length\":\"10115\",\"Content-Type\":\"application/x-amz-json-1.1\",\"Date\":\"Fri, 27 Feb 2026 05:08:39 GMT\",\"x-amzn-RequestId\":\"87724547-631e-4bec-8815-5dac6073fe53\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"87724547-631e-4bec-8815-5dac6073fe53\"},\"Build\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:39.482000-05:00",
            "type": "TaskStateExited",
            "id": 18,
            "previousEventId": 17,
            "stateExitedEventDetails": {
                "name": "BringupInfra",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"bringup\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"}}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:39.482000-05:00",
            "type": "PassStateEntered",
            "id": 19,
            "previousEventId": 18,
            "stateEnteredEventDetails": {
                "name": "SetPhaseResolveRunner",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"bringup\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"}}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:39.482000-05:00",
            "type": "PassStateExited",
            "id": 20,
            "previousEventId": 19,
            "stateExitedEventDetails": {
                "name": "SetPhaseResolveRunner",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"resolve_runner\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"}}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:39.482000-05:00",
            "type": "TaskStateEntered",
            "id": 21,
            "previousEventId": 20,
            "stateEnteredEventDetails": {
                "name": "ResolveRunner",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"resolve_runner\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"}}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:39.482000-05:00",
            "type": "TaskScheduled",
            "id": 22,
            "previousEventId": 21,
            "taskScheduledEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke",
                "region": "us-east-1",
                "parameters": "{\"FunctionName\":\"arn:aws:lambda:us-east-1:048622080012:function:signalcraft-dr-orchestrator-runner\",\"Payload\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"}}"
            }
        },
        {
            "timestamp": "2026-02-27T00:08:39.556000-05:00",
            "type": "TaskStarted",
            "id": 23,
            "previousEventId": 22,
            "taskStartedEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke"
            }
        },
        {
            "timestamp": "2026-02-27T00:08:41.991000-05:00",
            "type": "TaskSucceeded",
            "id": 24,
            "previousEventId": 23,
            "taskSucceededEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke",
                "output": "{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"ok\":true,\"phase_name\":\"resolve_runner\",\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\",\"failure_reason\":\"\"},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"dc09b5b9-40c3-4b14-89d8-ccd443376c58\"],\"Content-Length\":[\"744\"],\"Date\":[\"Fri, 27 Feb 2026 05:08:41 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-69a126d7-5e343e2826bbcb271c422700;Parent=5b612d2e0ea2cac3;Sampled=0;Lineage=1:ba18b611:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"744\",\"Content-Type\":\"application/json\",\"Date\":\"Fri, 27 Feb 2026 05:08:41 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"dc09b5b9-40c3-4b14-89d8-ccd443376c58\",\"X-Amzn-Trace-Id\":\"Root=1-69a126d7-5e343e2826bbcb271c422700;Parent=5b612d2e0ea2cac3;Sampled=0;Lineage=1:ba18b611:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"dc09b5b9-40c3-4b14-89d8-ccd443376c58\"},\"StatusCode\":200}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:42.017000-05:00",
            "type": "TaskStateExited",
            "id": 25,
            "previousEventId": 24,
            "stateExitedEventDetails": {
                "name": "ResolveRunner",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"resolve_runner\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"}}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:42.017000-05:00",
            "type": "PassStateEntered",
            "id": 26,
            "previousEventId": 25,
            "stateEnteredEventDetails": {
                "name": "SetPhaseRestore",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"resolve_runner\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"}}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:42.017000-05:00",
            "type": "PassStateExited",
            "id": 27,
            "previousEventId": 26,
            "stateExitedEventDetails": {
                "name": "SetPhaseRestore",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"restore\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"}}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:42.017000-05:00",
            "type": "TaskStateEntered",
            "id": 28,
            "previousEventId": 27,
            "stateEnteredEventDetails": {
                "name": "Restore",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"restore\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"}}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:42.017000-05:00",
            "type": "TaskScheduled",
            "id": 29,
            "previousEventId": 28,
            "taskScheduledEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke",
                "region": "us-east-1",
                "parameters": "{\"FunctionName\":\"arn:aws:lambda:us-east-1:048622080012:function:signalcraft-dr-orchestrator-runner\",\"Payload\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"}}"
            }
        },
        {
            "timestamp": "2026-02-27T00:08:42.093000-05:00",
            "type": "TaskStarted",
            "id": 30,
            "previousEventId": 29,
            "taskStartedEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke"
            }
        },
        {
            "timestamp": "2026-02-27T00:08:43.455000-05:00",
            "type": "TaskSucceeded",
            "id": 31,
            "previousEventId": 30,
            "taskSucceededEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke",
                "output": "{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"ok\":true,\"phase_name\":\"restore\",\"phase_inputs\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"},\"phase_outputs\":{\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"checked_keys\":[{\"key\":\"jobintel/backups/backup-20260221T061624Z/metadata.json\",\"content_length\":626,\"etag\":\"8517e952add8d9835b8db7224e31720c\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/state.tar.zst\",\"content_length\":1481,\"etag\":\"3d4c7aaa7fdaeb12137117c5eee24e48\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/manifests.tar.zst\",\"content_length\":19096,\"etag\":\"9eaa7ca111551eb130c8fb98c3e6fd8c\"}],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/restore.json\",\"failure_reason\":\"\"},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"ae299a27-13b4-48b4-abef-b15e95b062be\"],\"Content-Length\":[\"1161\"],\"Date\":[\"Fri, 27 Feb 2026 05:08:43 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-69a126da-6d3a550f1ee8ef0367c3a88f;Parent=721ec558bee39b51;Sampled=0;Lineage=1:ba18b611:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"1161\",\"Content-Type\":\"application/json\",\"Date\":\"Fri, 27 Feb 2026 05:08:43 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"ae299a27-13b4-48b4-abef-b15e95b062be\",\"X-Amzn-Trace-Id\":\"Root=1-69a126da-6d3a550f1ee8ef0367c3a88f;Parent=721ec558bee39b51;Sampled=0;Lineage=1:ba18b611:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"ae299a27-13b4-48b4-abef-b15e95b062be\"},\"StatusCode\":200}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:43.480000-05:00",
            "type": "TaskStateExited",
            "id": 32,
            "previousEventId": 31,
            "stateExitedEventDetails": {
                "name": "Restore",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"restore\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"},\"restore\":{\"phase_inputs\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"restore\",\"phase_outputs\":{\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"checked_keys\":[{\"key\":\"jobintel/backups/backup-20260221T061624Z/metadata.json\",\"content_length\":626,\"etag\":\"8517e952add8d9835b8db7224e31720c\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/state.tar.zst\",\"content_length\":1481,\"etag\":\"3d4c7aaa7fdaeb12137117c5eee24e48\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/manifests.tar.zst\",\"content_length\":19096,\"etag\":\"9eaa7ca111551eb130c8fb98c3e6fd8c\"}],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/restore.json\"}}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:43.480000-05:00",
            "type": "PassStateEntered",
            "id": 33,
            "previousEventId": 32,
            "stateEnteredEventDetails": {
                "name": "SetPhaseValidate",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"restore\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"},\"restore\":{\"phase_inputs\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"restore\",\"phase_outputs\":{\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"checked_keys\":[{\"key\":\"jobintel/backups/backup-20260221T061624Z/metadata.json\",\"content_length\":626,\"etag\":\"8517e952add8d9835b8db7224e31720c\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/state.tar.zst\",\"content_length\":1481,\"etag\":\"3d4c7aaa7fdaeb12137117c5eee24e48\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/manifests.tar.zst\",\"content_length\":19096,\"etag\":\"9eaa7ca111551eb130c8fb98c3e6fd8c\"}],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/restore.json\"}}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:43.480000-05:00",
            "type": "PassStateExited",
            "id": 34,
            "previousEventId": 33,
            "stateExitedEventDetails": {
                "name": "SetPhaseValidate",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"validate\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"},\"restore\":{\"phase_inputs\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"restore\",\"phase_outputs\":{\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"checked_keys\":[{\"key\":\"jobintel/backups/backup-20260221T061624Z/metadata.json\",\"content_length\":626,\"etag\":\"8517e952add8d9835b8db7224e31720c\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/state.tar.zst\",\"content_length\":1481,\"etag\":\"3d4c7aaa7fdaeb12137117c5eee24e48\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/manifests.tar.zst\",\"content_length\":19096,\"etag\":\"9eaa7ca111551eb130c8fb98c3e6fd8c\"}],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/restore.json\"}}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:43.480000-05:00",
            "type": "TaskStateEntered",
            "id": 35,
            "previousEventId": 34,
            "stateEnteredEventDetails": {
                "name": "Validate",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"validate\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"},\"restore\":{\"phase_inputs\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"restore\",\"phase_outputs\":{\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"checked_keys\":[{\"key\":\"jobintel/backups/backup-20260221T061624Z/metadata.json\",\"content_length\":626,\"etag\":\"8517e952add8d9835b8db7224e31720c\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/state.tar.zst\",\"content_length\":1481,\"etag\":\"3d4c7aaa7fdaeb12137117c5eee24e48\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/manifests.tar.zst\",\"content_length\":19096,\"etag\":\"9eaa7ca111551eb130c8fb98c3e6fd8c\"}],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/restore.json\"}}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:43.480000-05:00",
            "type": "TaskScheduled",
            "id": 36,
            "previousEventId": 35,
            "taskScheduledEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke",
                "region": "us-east-1",
                "parameters": "{\"FunctionName\":\"arn:aws:lambda:us-east-1:048622080012:function:signalcraft-dr-orchestrator-runner\",\"Payload\":{\"action\":\"validate\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"instance_id\":\"i-0313e98010ecef6e0\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"validate_timeout_seconds\":300,\"namespace\":\"jobintel\",\"region\":\"us-east-1\"}}"
            }
        },
        {
            "timestamp": "2026-02-27T00:08:43.551000-05:00",
            "type": "TaskStarted",
            "id": 37,
            "previousEventId": 36,
            "taskStartedEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke"
            }
        },
        {
            "timestamp": "2026-02-27T00:08:50.460000-05:00",
            "type": "TaskSucceeded",
            "id": 38,
            "previousEventId": 37,
            "taskSucceededEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke",
                "output": "{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"ok\":true,\"phase_name\":\"validate\",\"phase_inputs\":{\"action\":\"validate\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"instance_id\":\"i-0313e98010ecef6e0\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"validate_timeout_seconds\":300,\"namespace\":\"jobintel\",\"region\":\"us-east-1\"},\"phase_outputs\":{\"command_id\":\"76a7a627-8bdf-42f2-9876-9ea473be4f2d\",\"status\":\"Success\",\"stdout_tail\":\"NAME              STATUS   ROLES                  AGE   VERSION        INTERNAL-IP    EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION    CONTAINER-RUNTIME\\nip-172-31-29-47   Ready    control-plane,master   22m   v1.31.5+k3s1   172.31.29.47   <none>        Ubuntu 24.04.4 LTS   6.17.0-1007-aws   containerd://1.7.23-k3s2\\nnamespace/jobintel created\\n\",\"stderr_tail\":\"\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/validate.json\",\"failure_reason\":\"\"},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"27a60090-644e-4807-95d2-c9a4d2ebf30c\"],\"Content-Length\":[\"1060\"],\"Date\":[\"Fri, 27 Feb 2026 05:08:50 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-69a126db-4d6659e336ebb6d401ed33b8;Parent=6de9df91d9c2b9a3;Sampled=0;Lineage=1:ba18b611:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"1060\",\"Content-Type\":\"application/json\",\"Date\":\"Fri, 27 Feb 2026 05:08:50 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"27a60090-644e-4807-95d2-c9a4d2ebf30c\",\"X-Amzn-Trace-Id\":\"Root=1-69a126db-4d6659e336ebb6d401ed33b8;Parent=6de9df91d9c2b9a3;Sampled=0;Lineage=1:ba18b611:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"27a60090-644e-4807-95d2-c9a4d2ebf30c\"},\"StatusCode\":200}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:50.482000-05:00",
            "type": "TaskStateExited",
            "id": 39,
            "previousEventId": 38,
            "stateExitedEventDetails": {
                "name": "Validate",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"validate\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"},\"restore\":{\"phase_inputs\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"restore\",\"phase_outputs\":{\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"checked_keys\":[{\"key\":\"jobintel/backups/backup-20260221T061624Z/metadata.json\",\"content_length\":626,\"etag\":\"8517e952add8d9835b8db7224e31720c\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/state.tar.zst\",\"content_length\":1481,\"etag\":\"3d4c7aaa7fdaeb12137117c5eee24e48\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/manifests.tar.zst\",\"content_length\":19096,\"etag\":\"9eaa7ca111551eb130c8fb98c3e6fd8c\"}],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/restore.json\"},\"validate\":{\"phase_inputs\":{\"action\":\"validate\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"instance_id\":\"i-0313e98010ecef6e0\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"validate_timeout_seconds\":300,\"namespace\":\"jobintel\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"validate\",\"phase_outputs\":{\"command_id\":\"76a7a627-8bdf-42f2-9876-9ea473be4f2d\",\"status\":\"Success\",\"stdout_tail\":\"NAME              STATUS   ROLES                  AGE   VERSION        INTERNAL-IP    EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION    CONTAINER-RUNTIME\\nip-172-31-29-47   Ready    control-plane,master   22m   v1.31.5+k3s1   172.31.29.47   <none>        Ubuntu 24.04.4 LTS   6.17.0-1007-aws   containerd://1.7.23-k3s2\\nnamespace/jobintel created\\n\",\"stderr_tail\":\"\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/validate.json\"}}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:50.482000-05:00",
            "type": "PassStateEntered",
            "id": 40,
            "previousEventId": 39,
            "stateEnteredEventDetails": {
                "name": "SetPhaseNotify",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"validate\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"},\"restore\":{\"phase_inputs\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"restore\",\"phase_outputs\":{\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"checked_keys\":[{\"key\":\"jobintel/backups/backup-20260221T061624Z/metadata.json\",\"content_length\":626,\"etag\":\"8517e952add8d9835b8db7224e31720c\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/state.tar.zst\",\"content_length\":1481,\"etag\":\"3d4c7aaa7fdaeb12137117c5eee24e48\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/manifests.tar.zst\",\"content_length\":19096,\"etag\":\"9eaa7ca111551eb130c8fb98c3e6fd8c\"}],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/restore.json\"},\"validate\":{\"phase_inputs\":{\"action\":\"validate\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"instance_id\":\"i-0313e98010ecef6e0\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"validate_timeout_seconds\":300,\"namespace\":\"jobintel\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"validate\",\"phase_outputs\":{\"command_id\":\"76a7a627-8bdf-42f2-9876-9ea473be4f2d\",\"status\":\"Success\",\"stdout_tail\":\"NAME              STATUS   ROLES                  AGE   VERSION        INTERNAL-IP    EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION    CONTAINER-RUNTIME\\nip-172-31-29-47   Ready    control-plane,master   22m   v1.31.5+k3s1   172.31.29.47   <none>        Ubuntu 24.04.4 LTS   6.17.0-1007-aws   containerd://1.7.23-k3s2\\nnamespace/jobintel created\\n\",\"stderr_tail\":\"\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/validate.json\"}}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:50.482000-05:00",
            "type": "PassStateExited",
            "id": 41,
            "previousEventId": 40,
            "stateExitedEventDetails": {
                "name": "SetPhaseNotify",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"notify\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"},\"restore\":{\"phase_inputs\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"restore\",\"phase_outputs\":{\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"checked_keys\":[{\"key\":\"jobintel/backups/backup-20260221T061624Z/metadata.json\",\"content_length\":626,\"etag\":\"8517e952add8d9835b8db7224e31720c\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/state.tar.zst\",\"content_length\":1481,\"etag\":\"3d4c7aaa7fdaeb12137117c5eee24e48\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/manifests.tar.zst\",\"content_length\":19096,\"etag\":\"9eaa7ca111551eb130c8fb98c3e6fd8c\"}],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/restore.json\"},\"validate\":{\"phase_inputs\":{\"action\":\"validate\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"instance_id\":\"i-0313e98010ecef6e0\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"validate_timeout_seconds\":300,\"namespace\":\"jobintel\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"validate\",\"phase_outputs\":{\"command_id\":\"76a7a627-8bdf-42f2-9876-9ea473be4f2d\",\"status\":\"Success\",\"stdout_tail\":\"NAME              STATUS   ROLES                  AGE   VERSION        INTERNAL-IP    EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION    CONTAINER-RUNTIME\\nip-172-31-29-47   Ready    control-plane,master   22m   v1.31.5+k3s1   172.31.29.47   <none>        Ubuntu 24.04.4 LTS   6.17.0-1007-aws   containerd://1.7.23-k3s2\\nnamespace/jobintel created\\n\",\"stderr_tail\":\"\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/validate.json\"}}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:50.482000-05:00",
            "type": "TaskStateEntered",
            "id": 42,
            "previousEventId": 41,
            "stateEnteredEventDetails": {
                "name": "NotifyValidation",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"notify\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"},\"restore\":{\"phase_inputs\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"restore\",\"phase_outputs\":{\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"checked_keys\":[{\"key\":\"jobintel/backups/backup-20260221T061624Z/metadata.json\",\"content_length\":626,\"etag\":\"8517e952add8d9835b8db7224e31720c\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/state.tar.zst\",\"content_length\":1481,\"etag\":\"3d4c7aaa7fdaeb12137117c5eee24e48\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/manifests.tar.zst\",\"content_length\":19096,\"etag\":\"9eaa7ca111551eb130c8fb98c3e6fd8c\"}],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/restore.json\"},\"validate\":{\"phase_inputs\":{\"action\":\"validate\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"instance_id\":\"i-0313e98010ecef6e0\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"validate_timeout_seconds\":300,\"namespace\":\"jobintel\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"validate\",\"phase_outputs\":{\"command_id\":\"76a7a627-8bdf-42f2-9876-9ea473be4f2d\",\"status\":\"Success\",\"stdout_tail\":\"NAME              STATUS   ROLES                  AGE   VERSION        INTERNAL-IP    EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION    CONTAINER-RUNTIME\\nip-172-31-29-47   Ready    control-plane,master   22m   v1.31.5+k3s1   172.31.29.47   <none>        Ubuntu 24.04.4 LTS   6.17.0-1007-aws   containerd://1.7.23-k3s2\\nnamespace/jobintel created\\n\",\"stderr_tail\":\"\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/validate.json\"}}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:50.482000-05:00",
            "type": "TaskScheduled",
            "id": 43,
            "previousEventId": 42,
            "taskScheduledEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke",
                "region": "us-east-1",
                "parameters": "{\"FunctionName\":\"arn:aws:lambda:us-east-1:048622080012:function:signalcraft-dr-orchestrator-runner\",\"Payload\":{\"action\":\"notify\",\"status\":\"dr_validation_completed\",\"summary\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"public_ip\":\"3.88.91.148\",\"reasons\":[],\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"needs_dr\":true,\"validate\":\"Success\"},\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"region\":\"us-east-1\"}}"
            }
        },
        {
            "timestamp": "2026-02-27T00:08:50.564000-05:00",
            "type": "TaskStarted",
            "id": 44,
            "previousEventId": 43,
            "taskStartedEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke"
            }
        },
        {
            "timestamp": "2026-02-27T00:08:51.997000-05:00",
            "type": "TaskSucceeded",
            "id": 45,
            "previousEventId": 44,
            "taskSucceededEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke",
                "output": "{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"ok\":true,\"phase_name\":\"notify\",\"phase_inputs\":{\"action\":\"notify\",\"status\":\"dr_validation_completed\",\"summary\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"public_ip\":\"3.88.91.148\",\"reasons\":[],\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"needs_dr\":true,\"validate\":\"Success\"},\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"region\":\"us-east-1\"},\"phase_outputs\":{\"published\":true,\"message_id\":\"d0592f8a-b75e-5933-b521-4d919e7dab93\",\"message\":{\"kind\":\"dr_orchestrator_status\",\"timestamp_utc\":\"2026-02-27T05:08:51Z\",\"status\":\"dr_validation_completed\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"details\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"public_ip\":\"3.88.91.148\",\"reasons\":[],\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"needs_dr\":true,\"validate\":\"Success\"}},\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/notify.json\",\"failure_reason\":\"\"},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"fc26318d-75d1-451c-ba7d-06635388b978\"],\"Content-Length\":[\"1302\"],\"Date\":[\"Fri, 27 Feb 2026 05:08:51 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-69a126e2-084351c94a12d2ab41c4a82b;Parent=1f57d9b958f3f8af;Sampled=0;Lineage=1:ba18b611:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"1302\",\"Content-Type\":\"application/json\",\"Date\":\"Fri, 27 Feb 2026 05:08:51 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"fc26318d-75d1-451c-ba7d-06635388b978\",\"X-Amzn-Trace-Id\":\"Root=1-69a126e2-084351c94a12d2ab41c4a82b;Parent=1f57d9b958f3f8af;Sampled=0;Lineage=1:ba18b611:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"fc26318d-75d1-451c-ba7d-06635388b978\"},\"StatusCode\":200}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:52.020000-05:00",
            "type": "TaskStateExited",
            "id": 46,
            "previousEventId": 45,
            "stateExitedEventDetails": {
                "name": "NotifyValidation",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"notify\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"},\"restore\":{\"phase_inputs\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"restore\",\"phase_outputs\":{\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"checked_keys\":[{\"key\":\"jobintel/backups/backup-20260221T061624Z/metadata.json\",\"content_length\":626,\"etag\":\"8517e952add8d9835b8db7224e31720c\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/state.tar.zst\",\"content_length\":1481,\"etag\":\"3d4c7aaa7fdaeb12137117c5eee24e48\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/manifests.tar.zst\",\"content_length\":19096,\"etag\":\"9eaa7ca111551eb130c8fb98c3e6fd8c\"}],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/restore.json\"},\"validate\":{\"phase_inputs\":{\"action\":\"validate\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"instance_id\":\"i-0313e98010ecef6e0\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"validate_timeout_seconds\":300,\"namespace\":\"jobintel\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"validate\",\"phase_outputs\":{\"command_id\":\"76a7a627-8bdf-42f2-9876-9ea473be4f2d\",\"status\":\"Success\",\"stdout_tail\":\"NAME              STATUS   ROLES                  AGE   VERSION        INTERNAL-IP    EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION    CONTAINER-RUNTIME\\nip-172-31-29-47   Ready    control-plane,master   22m   v1.31.5+k3s1   172.31.29.47   <none>        Ubuntu 24.04.4 LTS   6.17.0-1007-aws   containerd://1.7.23-k3s2\\nnamespace/jobintel created\\n\",\"stderr_tail\":\"\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/validate.json\"},\"notify\":{\"phase_inputs\":{\"action\":\"notify\",\"status\":\"dr_validation_completed\",\"summary\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"public_ip\":\"3.88.91.148\",\"reasons\":[],\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"needs_dr\":true,\"validate\":\"Success\"},\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"notify\",\"phase_outputs\":{\"published\":true,\"message_id\":\"d0592f8a-b75e-5933-b521-4d919e7dab93\",\"message\":{\"kind\":\"dr_orchestrator_status\",\"timestamp_utc\":\"2026-02-27T05:08:51Z\",\"status\":\"dr_validation_completed\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"details\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"public_ip\":\"3.88.91.148\",\"reasons\":[],\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"needs_dr\":true,\"validate\":\"Success\"}},\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/notify.json\"}}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:52.020000-05:00",
            "type": "PassStateEntered",
            "id": 47,
            "previousEventId": 46,
            "stateEnteredEventDetails": {
                "name": "SetPhaseManualApproval",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"notify\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"},\"restore\":{\"phase_inputs\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"restore\",\"phase_outputs\":{\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"checked_keys\":[{\"key\":\"jobintel/backups/backup-20260221T061624Z/metadata.json\",\"content_length\":626,\"etag\":\"8517e952add8d9835b8db7224e31720c\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/state.tar.zst\",\"content_length\":1481,\"etag\":\"3d4c7aaa7fdaeb12137117c5eee24e48\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/manifests.tar.zst\",\"content_length\":19096,\"etag\":\"9eaa7ca111551eb130c8fb98c3e6fd8c\"}],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/restore.json\"},\"validate\":{\"phase_inputs\":{\"action\":\"validate\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"instance_id\":\"i-0313e98010ecef6e0\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"validate_timeout_seconds\":300,\"namespace\":\"jobintel\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"validate\",\"phase_outputs\":{\"command_id\":\"76a7a627-8bdf-42f2-9876-9ea473be4f2d\",\"status\":\"Success\",\"stdout_tail\":\"NAME              STATUS   ROLES                  AGE   VERSION        INTERNAL-IP    EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION    CONTAINER-RUNTIME\\nip-172-31-29-47   Ready    control-plane,master   22m   v1.31.5+k3s1   172.31.29.47   <none>        Ubuntu 24.04.4 LTS   6.17.0-1007-aws   containerd://1.7.23-k3s2\\nnamespace/jobintel created\\n\",\"stderr_tail\":\"\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/validate.json\"},\"notify\":{\"phase_inputs\":{\"action\":\"notify\",\"status\":\"dr_validation_completed\",\"summary\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"public_ip\":\"3.88.91.148\",\"reasons\":[],\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"needs_dr\":true,\"validate\":\"Success\"},\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"notify\",\"phase_outputs\":{\"published\":true,\"message_id\":\"d0592f8a-b75e-5933-b521-4d919e7dab93\",\"message\":{\"kind\":\"dr_orchestrator_status\",\"timestamp_utc\":\"2026-02-27T05:08:51Z\",\"status\":\"dr_validation_completed\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"details\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"public_ip\":\"3.88.91.148\",\"reasons\":[],\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"needs_dr\":true,\"validate\":\"Success\"}},\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/notify.json\"}}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:52.020000-05:00",
            "type": "PassStateExited",
            "id": 48,
            "previousEventId": 47,
            "stateExitedEventDetails": {
                "name": "SetPhaseManualApproval",
                "output": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"request_manual_approval\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"},\"restore\":{\"phase_inputs\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"restore\",\"phase_outputs\":{\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"checked_keys\":[{\"key\":\"jobintel/backups/backup-20260221T061624Z/metadata.json\",\"content_length\":626,\"etag\":\"8517e952add8d9835b8db7224e31720c\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/state.tar.zst\",\"content_length\":1481,\"etag\":\"3d4c7aaa7fdaeb12137117c5eee24e48\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/manifests.tar.zst\",\"content_length\":19096,\"etag\":\"9eaa7ca111551eb130c8fb98c3e6fd8c\"}],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/restore.json\"},\"validate\":{\"phase_inputs\":{\"action\":\"validate\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"instance_id\":\"i-0313e98010ecef6e0\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"validate_timeout_seconds\":300,\"namespace\":\"jobintel\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"validate\",\"phase_outputs\":{\"command_id\":\"76a7a627-8bdf-42f2-9876-9ea473be4f2d\",\"status\":\"Success\",\"stdout_tail\":\"NAME              STATUS   ROLES                  AGE   VERSION        INTERNAL-IP    EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION    CONTAINER-RUNTIME\\nip-172-31-29-47   Ready    control-plane,master   22m   v1.31.5+k3s1   172.31.29.47   <none>        Ubuntu 24.04.4 LTS   6.17.0-1007-aws   containerd://1.7.23-k3s2\\nnamespace/jobintel created\\n\",\"stderr_tail\":\"\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/validate.json\"},\"notify\":{\"phase_inputs\":{\"action\":\"notify\",\"status\":\"dr_validation_completed\",\"summary\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"public_ip\":\"3.88.91.148\",\"reasons\":[],\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"needs_dr\":true,\"validate\":\"Success\"},\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"notify\",\"phase_outputs\":{\"published\":true,\"message_id\":\"d0592f8a-b75e-5933-b521-4d919e7dab93\",\"message\":{\"kind\":\"dr_orchestrator_status\",\"timestamp_utc\":\"2026-02-27T05:08:51Z\",\"status\":\"dr_validation_completed\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"details\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"public_ip\":\"3.88.91.148\",\"reasons\":[],\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"needs_dr\":true,\"validate\":\"Success\"}},\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/notify.json\"}}}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:52.020000-05:00",
            "type": "TaskStateEntered",
            "id": 49,
            "previousEventId": 48,
            "stateEnteredEventDetails": {
                "name": "RequestManualApproval",
                "input": "{\"expected_account_id\":\"048622080012\",\"region\":\"us-east-1\",\"project\":\"signalcraft\",\"publish_bucket\":\"jobintel-prod1\",\"publish_prefix\":\"jobintel\",\"backup_bucket\":\"jobintel-prod1\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"provider\":\"openai\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"max_freshness_hours\":6,\"metric_namespace\":\"SignalCraft/DR\",\"dr_runner_name\":\"jobintel-dr-runner\",\"dr_vpc_id\":\"vpc-4362fc3e\",\"dr_subnet_id\":\"subnet-11001d5c\",\"dr_allowed_cidr\":\"10.0.0.0/8\",\"dr_key_name\":\"\",\"dr_instance_type\":\"t4g.small\",\"dr_ami_id\":\"\",\"namespace\":\"jobintel\",\"validate_timeout_seconds\":300,\"force_run\":true,\"current_phase\":{\"name\":\"request_manual_approval\"},\"phase_results\":{\"check_health\":{\"phase_inputs\":{\"action\":\"check_health\",\"publish_prefix\":\"jobintel\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"profile\":\"cs\",\"expected_marker_file\":\"openai_top.cs.md\",\"project\":\"signalcraft\",\"max_freshness_hours\":6,\"force_run\":true,\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"publish_bucket\":\"jobintel-prod1\",\"receipt_bucket\":\"jobintel-prod1\",\"provider\":\"openai\",\"metric_namespace\":\"SignalCraft/DR\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"check_health\",\"phase_outputs\":{\"needs_dr\":true,\"pipeline_freshness_hours\":4.744,\"pipeline_freshness_ok\":true,\"publish_correctness_ok\":true,\"run_id\":\"2026-02-27T00:22:29.934039+00:00\",\"global_pointer_key\":\"jobintel/state/last_success.json\",\"provider_pointer_key\":\"jobintel/state/openai/cs/last_success.json\",\"expected_marker_key\":\"jobintel/latest/openai/cs/openai_top.cs.md\",\"reasons\":[],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/check_health.json\"},\"bringup\":{\"failure_reason\":\"\",\"phase_inputs\":{\"action\":\"bringup\",\"backend_key\":\"jobintel/dr/terraform/dr-runner.tfstate\",\"backend_lock\":\"signalcraft-dr-tf-lock\"},\"phase_name\":\"bringup\",\"phase_outputs\":{\"Arn\":\"arn:aws:codebuild:us-east-1:048622080012:build/signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Artifacts\":{\"Location\":\"\",\"OverrideArtifactName\":false},\"BuildComplete\":true,\"BuildNumber\":9,\"BuildStatus\":\"SUCCEEDED\",\"Cache\":{\"Type\":\"NO_CACHE\"},\"CurrentPhase\":\"COMPLETED\",\"EncryptionKey\":\"arn:aws:kms:us-east-1:048622080012:alias/aws/s3\",\"EndTime\":1772168914193,\"Environment\":{\"ComputeType\":\"BUILD_GENERAL1_MEDIUM\",\"EnvironmentVariables\":[{\"Name\":\"RECEIPT_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_allowed_cidr\",\"Type\":\"PLAINTEXT\",\"Value\":\"10.0.0.0/8\"},{\"Name\":\"TF_BUNDLE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel-prod1\"},{\"Name\":\"TF_VAR_instance_type\",\"Type\":\"PLAINTEXT\",\"Value\":\"t4g.small\"},{\"Name\":\"TF_VAR_subnet_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"subnet-11001d5c\"},{\"Name\":\"AWS_REGION\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"TF_VAR_key_name\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_BUNDLE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/artifacts/dr-terraform-module.zip\"},{\"Name\":\"TF_STATE_KEY\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr/terraform/dr-runner.tfstate\"},{\"Name\":\"TF_VERSION\",\"Type\":\"PLAINTEXT\",\"Value\":\"1.8.5\"},{\"Name\":\"ACTION\",\"Type\":\"PLAINTEXT\",\"Value\":\"bringup\"},{\"Name\":\"TF_VAR_ami_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"\"},{\"Name\":\"TF_VAR_region\",\"Type\":\"PLAINTEXT\",\"Value\":\"us-east-1\"},{\"Name\":\"EXPECTED_ACCOUNT_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"048622080012\"},{\"Name\":\"TF_VAR_vpc_id\",\"Type\":\"PLAINTEXT\",\"Value\":\"vpc-4362fc3e\"},{\"Name\":\"RECEIPT_PREFIX\",\"Type\":\"PLAINTEXT\",\"Value\":\"jobintel/dr-orchestrator/receipts\"},{\"Name\":\"TF_STATE_BUCKET\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tfstate-048622080012-us-east-1\"},{\"Name\":\"TF_STATE_DYNAMODB_TABLE\",\"Type\":\"PLAINTEXT\",\"Value\":\"signalcraft-dr-tf-lock\"},{\"Name\":\"EXECUTION_ID\",\"Type\":\"PLAINTEXT\",\"Value\":\"m19b-success-true-20260227T050707Z\"}],\"Image\":\"aws/codebuild/standard:7.0\",\"ImagePullCredentialsType\":\"CODEBUILD\",\"PrivilegedMode\":false,\"Type\":\"LINUX_CONTAINER\"},\"Id\":\"signalcraft-dr-orchestrator-dr-infra:74694e31-7363-4a1c-af25-f5b65336228f\",\"Initiator\":\"states/signalcraft-dr-orchestrator-state-machine\",\"Logs\":{\"CloudWatchLogs\":{\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"Status\":\"ENABLED\"},\"CloudWatchLogsArn\":\"arn:aws:logs:us-east-1:048622080012:log-group:/aws/codebuild/signalcraft-dr-orchestrator-dr-infra:log-stream:74694e31-7363-4a1c-af25-f5b65336228f\",\"DeepLink\":\"https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Fcodebuild$252Fsignalcraft-dr-orchestrator-dr-infra/log-events/74694e31-7363-4a1c-af25-f5b65336228f\",\"GroupName\":\"/aws/codebuild/signalcraft-dr-orchestrator-dr-infra\",\"S3Logs\":{\"EncryptionDisabled\":false,\"Status\":\"DISABLED\"},\"StreamName\":\"74694e31-7363-4a1c-af25-f5b65336228f\"},\"Phases\":[{\"DurationInSeconds\":0,\"EndTime\":1772168831292,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"SUBMITTED\",\"StartTime\":1772168831191},{\"DurationInSeconds\":0,\"EndTime\":1772168832049,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"QUEUED\",\"StartTime\":1772168831292},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":4,\"EndTime\":1772168836793,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PROVISIONING\",\"StartTime\":1772168832049},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168837707,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"DOWNLOAD_SOURCE\",\"StartTime\":1772168836793},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":35,\"EndTime\":1772168872837,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"INSTALL\",\"StartTime\":1772168837707},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168872878,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"PRE_BUILD\",\"StartTime\":1772168872837},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":40,\"EndTime\":1772168913791,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"BUILD\",\"StartTime\":1772168872878},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913835,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"POST_BUILD\",\"StartTime\":1772168913791},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168913897,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"UPLOAD_ARTIFACTS\",\"StartTime\":1772168913835},{\"Contexts\":[{\"Message\":\"\",\"StatusCode\":\"\"}],\"DurationInSeconds\":0,\"EndTime\":1772168914193,\"PhaseStatus\":\"SUCCEEDED\",\"PhaseType\":\"FINALIZING\",\"StartTime\":1772168913897},{\"PhaseType\":\"COMPLETED\",\"StartTime\":1772168914193}],\"ProjectName\":\"signalcraft-dr-orchestrator-dr-infra\",\"QueuedTimeoutInMinutes\":60,\"SecondarySourceVersions\":[],\"SecondarySources\":[],\"ServiceRole\":\"arn:aws:iam::048622080012:role/signalcraft-dr-orchestrator-codebuild-role\",\"Source\":{\"Buildspec\":\"\\\"env\\\":\\n  \\\"shell\\\": \\\"bash\\\"\\n\\\"phases\\\":\\n  \\\"build\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\": \\\\\\\"${ACTION:?ACTION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXECUTION_ID:?EXECUTION_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${EXPECTED_ACCOUNT_ID:?EXPECTED_ACCOUNT_ID is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${AWS_REGION:?AWS_REGION is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_BUCKET:?RECEIPT_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${RECEIPT_PREFIX:?RECEIPT_PREFIX is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_BUCKET:?TF_BUNDLE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_BUNDLE_KEY:?TF_BUNDLE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_BUCKET:?TF_STATE_BUCKET is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_KEY:?TF_STATE_KEY is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_STATE_DYNAMODB_TABLE:?TF_STATE_DYNAMODB_TABLE is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_region:?TF_VAR_region is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_vpc_id:?TF_VAR_vpc_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_subnet_id:?TF_VAR_subnet_id is required}\\\\\\\"\\\"\\n    - \\\": \\\\\\\"${TF_VAR_allowed_cidr:?TF_VAR_allowed_cidr is required}\\\\\\\"\\\"\\n    - \\\"ACTUAL_ACCOUNT_ID=\\\\\\\"$(aws sts get-caller-identity --query Account --output\\n      text)\\\\\\\"\\\"\\n    - |\\n      if [[ \\\"${ACTUAL_ACCOUNT_ID}\\\" != \\\"${EXPECTED_ACCOUNT_ID}\\\" ]]; then\\n        echo \\\"account mismatch: expected=${EXPECTED_ACCOUNT_ID} actual=${ACTUAL_ACCOUNT_ID}\\\" >&2\\n        exit 1\\n      fi\\n    - \\\"WORK_DIR=\\\\\\\"/tmp/dr-terraform\\\\\\\"\\\"\\n    - \\\"rm -rf \\\\\\\"${WORK_DIR}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"aws s3 cp \\\\\\\"s3://${TF_BUNDLE_BUCKET}/${TF_BUNDLE_KEY}\\\\\\\" /tmp/dr-terraform.zip\\\"\\n    - \\\"mkdir -p \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"unzip -q /tmp/dr-terraform.zip -d \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - \\\"cd \\\\\\\"${WORK_DIR}\\\\\\\"\\\"\\n    - |\\n      terraform init -input=false \\\\\\n        -backend-config=\\\"bucket=${TF_STATE_BUCKET}\\\" \\\\\\n        -backend-config=\\\"key=${TF_STATE_KEY}\\\" \\\\\\n        -backend-config=\\\"region=${AWS_REGION}\\\" \\\\\\n        -backend-config=\\\"dynamodb_table=${TF_STATE_DYNAMODB_TABLE}\\\" \\\\\\n        -backend-config=\\\"encrypt=true\\\"\\n    - \\\"terraform fmt -check\\\"\\n    - \\\"terraform validate\\\"\\n    - |\\n      tf_var_args=(\\n        -var \\\"region=${TF_VAR_region}\\\"\\n        -var \\\"vpc_id=${TF_VAR_vpc_id}\\\"\\n        -var \\\"subnet_id=${TF_VAR_subnet_id}\\\"\\n        -var \\\"allowed_cidr=${TF_VAR_allowed_cidr}\\\"\\n        -var \\\"instance_type=${TF_VAR_instance_type:-t4g.small}\\\"\\n      )\\n      if [[ -n \\\"${TF_VAR_key_name:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"key_name=${TF_VAR_key_name}\\\" )\\n      fi\\n      if [[ -n \\\"${TF_VAR_ami_id:-}\\\" ]]; then\\n        tf_var_args+=( -var \\\"ami_id=${TF_VAR_ami_id}\\\" )\\n      fi\\n\\n      case \\\"${ACTION}\\\" in\\n        bringup)\\n          terraform plan -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan\\n          terraform apply -auto-approve tfplan\\n          ;;\\n        teardown)\\n          terraform plan -destroy -input=false \\\"${tf_var_args[@]}\\\" -out=tfplan-destroy\\n          terraform apply -auto-approve tfplan-destroy\\n          ;;\\n        *)\\n          echo \\\"unsupported ACTION=${ACTION}\\\" >&2\\n          exit 2\\n          ;;\\n      esac\\n    - \\\"terraform output -json > /tmp/dr_tf_outputs.json || echo '{}' > /tmp/dr_tf_outputs.json\\\"\\n    - \\\"RECEIPT_KEY=\\\\\\\"${RECEIPT_PREFIX}/${EXECUTION_ID}/codebuild-${ACTION}.json\\\\\\\"\\\"\\n    - |\\n      python3 - <<'PY' > /tmp/codebuild_receipt.json\\n      import datetime as dt\\n      import json\\n      import os\\n      from pathlib import Path\\n\\n      outputs_path = Path('/tmp/dr_tf_outputs.json')\\n      outputs = json.loads(outputs_path.read_text(encoding='utf-8')) if outputs_path.exists() else {}\\n\\n      payload = {\\n          'schema_version': 1,\\n          'timestamp_utc': dt.datetime.now(dt.timezone.utc).strftime('%Y-%m-%dT%H:%M:%SZ'),\\n          'phase': os.environ['ACTION'],\\n          'status': 'ok',\\n          'execution_id': os.environ['EXECUTION_ID'],\\n          'build_id': os.environ.get('CODEBUILD_BUILD_ID', ''),\\n          'account_id': os.environ.get('ACTUAL_ACCOUNT_ID', ''),\\n          'region': os.environ['AWS_REGION'],\\n          'terraform_backend': {\\n              'bucket': os.environ['TF_STATE_BUCKET'],\\n              'key': os.environ['TF_STATE_KEY'],\\n              'dynamodb_table': os.environ['TF_STATE_DYNAMODB_TABLE'],\\n          },\\n          'terraform_outputs': outputs,\\n      }\\n      print(json.dumps(payload, indent=2, sort_keys=True))\\n      PY\\n    - \\\"aws s3 cp /tmp/codebuild_receipt.json \\\\\\\"s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\n      --content-type application/json\\\"\\n    - \\\"echo \\\\\\\"receipt=s3://${RECEIPT_BUCKET}/${RECEIPT_KEY}\\\\\\\"\\\"\\n  \\\"install\\\":\\n    \\\"commands\\\":\\n    - \\\"set -euo pipefail\\\"\\n    - \\\"apt-get update\\\"\\n    - \\\"DEBIAN_FRONTEND=noninteractive apt-get install -y unzip curl jq >/dev/null\\\"\\n    - \\\"curl -fsSL -o /tmp/terraform.zip \\\\\\\"https://releases.hashicorp.com/terraform/${TF_VERSION}/terraform_${TF_VERSION}_linux_amd64.zip\\\\\\\"\\\"\\n    - \\\"unzip -o /tmp/terraform.zip -d /usr/local/bin >/dev/null\\\"\\n    - \\\"terraform version\\\"\\n\\\"version\\\": 0.2\\n\",\"GitCloneDepth\":0,\"InsecureSsl\":false,\"Type\":\"NO_SOURCE\"},\"StartTime\":1772168831191,\"TimeoutInMinutes\":30},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/codebuild-bringup.json\"},\"resolve_runner\":{\"phase_inputs\":{\"action\":\"resolve_runner\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"dr_runner_name\":\"jobintel-dr-runner\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"resolve_runner\",\"phase_outputs\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"instance_state\":\"running\",\"public_ip\":\"3.88.91.148\",\"private_ip\":\"172.31.29.47\",\"key_name\":\"\",\"security_group_id\":\"sg-0bf417d856b521efa\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/resolve_runner.json\"},\"restore\":{\"phase_inputs\":{\"action\":\"restore\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"backup_required_keys\":[\"metadata.json\",\"state.tar.zst\",\"manifests.tar.zst\"],\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"restore\",\"phase_outputs\":{\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"checked_keys\":[{\"key\":\"jobintel/backups/backup-20260221T061624Z/metadata.json\",\"content_length\":626,\"etag\":\"8517e952add8d9835b8db7224e31720c\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/state.tar.zst\",\"content_length\":1481,\"etag\":\"3d4c7aaa7fdaeb12137117c5eee24e48\"},{\"key\":\"jobintel/backups/backup-20260221T061624Z/manifests.tar.zst\",\"content_length\":19096,\"etag\":\"9eaa7ca111551eb130c8fb98c3e6fd8c\"}],\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/restore.json\"},\"validate\":{\"phase_inputs\":{\"action\":\"validate\",\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"instance_id\":\"i-0313e98010ecef6e0\",\"receipt_bucket\":\"jobintel-prod1\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"validate_timeout_seconds\":300,\"namespace\":\"jobintel\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"validate\",\"phase_outputs\":{\"command_id\":\"76a7a627-8bdf-42f2-9876-9ea473be4f2d\",\"status\":\"Success\",\"stdout_tail\":\"NAME              STATUS   ROLES                  AGE   VERSION        INTERNAL-IP    EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION    CONTAINER-RUNTIME\\nip-172-31-29-47   Ready    control-plane,master   22m   v1.31.5+k3s1   172.31.29.47   <none>        Ubuntu 24.04.4 LTS   6.17.0-1007-aws   containerd://1.7.23-k3s2\\nnamespace/jobintel created\\n\",\"stderr_tail\":\"\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/validate.json\"},\"notify\":{\"phase_inputs\":{\"action\":\"notify\",\"status\":\"dr_validation_completed\",\"summary\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"public_ip\":\"3.88.91.148\",\"reasons\":[],\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"needs_dr\":true,\"validate\":\"Success\"},\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"region\":\"us-east-1\"},\"failure_reason\":\"\",\"phase_name\":\"notify\",\"phase_outputs\":{\"published\":true,\"message_id\":\"d0592f8a-b75e-5933-b521-4d919e7dab93\",\"message\":{\"kind\":\"dr_orchestrator_status\",\"timestamp_utc\":\"2026-02-27T05:08:51Z\",\"status\":\"dr_validation_completed\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"details\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"public_ip\":\"3.88.91.148\",\"reasons\":[],\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"needs_dr\":true,\"validate\":\"Success\"}},\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/notify.json\"}}}",
                "inputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:08:52.020000-05:00",
            "type": "TaskScheduled",
            "id": 50,
            "previousEventId": 49,
            "taskScheduledEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke.waitForTaskToken",
                "region": "us-east-1",
                "parameters": "{\"FunctionName\":\"arn:aws:lambda:us-east-1:048622080012:function:signalcraft-dr-orchestrator-runner\",\"Payload\":{\"action\":\"request_manual_approval\",\"summary\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"public_ip\":\"3.88.91.148\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"validate\":\"Success\"},\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"task_token\":\"AQCYAAAAKgAAAAMAAAAAAAAAAXx/n5c+7/XcWKJLYEpHDa6AXHsT5toNf9U6rILxO/xzZGDpfQ88AMcKPOELx7cnUfGdpXHTL3xTv7KR/NFvcxASJtTO6b/ipDgPCigVjsfIQRJurXtgDZSaR1yQ2vhn+uY=Ry3wmdNfE1uekLm1oEP09RshX7MIYmw51nDRLAYokuf5Rjsv20/TZ0EsYrkIft0hQ1eTzXoZVvNNbIK0Ku+X6E5baKQ/AELlxrJVoTGyCXOqYO6ij1kNBlhtlMqHqsZKhTrFaYaUwsaBQu7V4RIHdLRgDBycZONwlhDWlg5sGI2SbeWSRPoe4YRWqcX4OvyE2dQ9SRJBxAGUqELbpVuL43XY4sSGvzJrdgK/puADooC0z7EQ/s/Mz2+pKSQM2ihXhivh5AN6GYfpUhS3mGXcnhQeQI37PXxuFafwg6tvtqEs6/MmCev8D1SbpiHmVf9PP/OjaANdzxTEVjW5qi32A3LHdKFXItZXS/hh/BXb3hG+TOuFXg6BJj25P8Yi3mFTe3KUeOu4xlq0hqXCLmneG5qWJW27n9KXaPoF2vC4sI2MIpaqeeVBSyJXTWeChvsYCyTncrWv6pdcueN7gxlVu2bnB9gEWC+bwm0D1p5c6dVydPcG2GumiriyP6a2weV4yiguJncVmLwizM6Paab+\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"region\":\"us-east-1\"}}",
                "timeoutInSeconds": 86400
            }
        },
        {
            "timestamp": "2026-02-27T00:08:52.095000-05:00",
            "type": "TaskStarted",
            "id": 51,
            "previousEventId": 50,
            "taskStartedEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke.waitForTaskToken"
            }
        },
        {
            "timestamp": "2026-02-27T00:08:53.409000-05:00",
            "type": "TaskSubmitted",
            "id": 52,
            "previousEventId": 51,
            "taskSubmittedEventDetails": {
                "resourceType": "lambda",
                "resource": "invoke.waitForTaskToken",
                "output": "{\"ExecutedVersion\":\"$LATEST\",\"Payload\":{\"ok\":true,\"phase_name\":\"request_manual_approval\",\"phase_inputs\":{\"action\":\"request_manual_approval\",\"summary\":{\"instance_id\":\"i-0313e98010ecef6e0\",\"public_ip\":\"3.88.91.148\",\"backup_uri\":\"s3://jobintel-prod1/jobintel/backups/backup-20260221T061624Z\",\"validate\":\"Success\"},\"expected_account_id\":\"048622080012\",\"execution_id\":\"m19b-success-true-20260227T050707Z\",\"receipt_bucket\":\"jobintel-prod1\",\"notification_topic_arn\":\"arn:aws:sns:us-east-1:048622080012:signalcraft-dr-notifications\",\"task_token\":\"AQCYAAAAKgAAAAMAAAAAAAAAAXx/n5c+7/XcWKJLYEpHDa6AXHsT5toNf9U6rILxO/xzZGDpfQ88AMcKPOELx7cnUfGdpXHTL3xTv7KR/NFvcxASJtTO6b/ipDgPCigVjsfIQRJurXtgDZSaR1yQ2vhn+uY=Ry3wmdNfE1uekLm1oEP09RshX7MIYmw51nDRLAYokuf5Rjsv20/TZ0EsYrkIft0hQ1eTzXoZVvNNbIK0Ku+X6E5baKQ/AELlxrJVoTGyCXOqYO6ij1kNBlhtlMqHqsZKhTrFaYaUwsaBQu7V4RIHdLRgDBycZONwlhDWlg5sGI2SbeWSRPoe4YRWqcX4OvyE2dQ9SRJBxAGUqELbpVuL43XY4sSGvzJrdgK/puADooC0z7EQ/s/Mz2+pKSQM2ihXhivh5AN6GYfpUhS3mGXcnhQeQI37PXxuFafwg6tvtqEs6/MmCev8D1SbpiHmVf9PP/OjaANdzxTEVjW5qi32A3LHdKFXItZXS/hh/BXb3hG+TOuFXg6BJj25P8Yi3mFTe3KUeOu4xlq0hqXCLmneG5qWJW27n9KXaPoF2vC4sI2MIpaqeeVBSyJXTWeChvsYCyTncrWv6pdcueN7gxlVu2bnB9gEWC+bwm0D1p5c6dVydPcG2GumiriyP6a2weV4yiguJncVmLwizM6Paab+\",\"receipt_prefix\":\"jobintel/dr-orchestrator/receipts\",\"region\":\"us-east-1\"},\"phase_outputs\":{\"published\":true,\"message_id\":\"1cec6028-dee3-5502-8ece-0233f7c728e6\",\"task_token_hint\":\"AQCYAAAAKg...6Paab+\",\"account_id\":\"048622080012\",\"region\":\"us-east-1\"},\"receipt_uri\":\"s3://jobintel-prod1/jobintel/dr-orchestrator/receipts/m19b-success-true-20260227T050707Z/request_manual_approval.json\",\"failure_reason\":\"\"},\"SdkHttpMetadata\":{\"AllHttpHeaders\":{\"X-Amz-Executed-Version\":[\"$LATEST\"],\"x-amzn-Remapped-Content-Length\":[\"0\"],\"Connection\":[\"keep-alive\"],\"x-amzn-RequestId\":[\"dddd33d0-d4e5-40aa-91a8-8f5660e73e30\"],\"Content-Length\":[\"1639\"],\"Date\":[\"Fri, 27 Feb 2026 05:08:53 GMT\"],\"X-Amzn-Trace-Id\":[\"Root=1-69a126e4-65c0fc0524bff10c7e026cf2;Parent=66dfe62edd3ee0e7;Sampled=0;Lineage=1:ba18b611:0\"],\"Content-Type\":[\"application/json\"]},\"HttpHeaders\":{\"Connection\":\"keep-alive\",\"Content-Length\":\"1639\",\"Content-Type\":\"application/json\",\"Date\":\"Fri, 27 Feb 2026 05:08:53 GMT\",\"X-Amz-Executed-Version\":\"$LATEST\",\"x-amzn-Remapped-Content-Length\":\"0\",\"x-amzn-RequestId\":\"dddd33d0-d4e5-40aa-91a8-8f5660e73e30\",\"X-Amzn-Trace-Id\":\"Root=1-69a126e4-65c0fc0524bff10c7e026cf2;Parent=66dfe62edd3ee0e7;Sampled=0;Lineage=1:ba18b611:0\"},\"HttpStatusCode\":200},\"SdkResponseMetadata\":{\"RequestId\":\"dddd33d0-d4e5-40aa-91a8-8f5660e73e30\"},\"StatusCode\":200}",
                "outputDetails": {
                    "truncated": false
                }
            }
        },
        {
            "timestamp": "2026-02-27T00:14:53.951000-05:00",
            "type": "ExecutionAborted",
            "id": 53,
            "previousEventId": 0,
            "executionAbortedEventDetails": {
                "cause": "Manual stop after success-path reached request_manual_approval; no promote requested"
            }
        }
    ]
}
