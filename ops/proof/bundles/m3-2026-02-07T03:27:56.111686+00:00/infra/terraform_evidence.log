$ cat /Users/christophermenendez/Projects/job-intelligence-engine/ops/proof/bundles/m3-2026-02-07T03:27:56.111686+00:00/infra/provision_terraform_apply_reconcile.log
[0m[1maws_ec2_tag.subnet_cluster["subnet-11001d5c"]: Refreshing state... [id=subnet-11001d5c,kubernetes.io/cluster/jobintel-eks][0m
[0m[1maws_ec2_tag.subnet_cluster["subnet-1e470941"]: Refreshing state... [id=subnet-1e470941,kubernetes.io/cluster/jobintel-eks][0m
[0m[1maws_ec2_tag.subnet_cluster["subnet-f23c7194"]: Refreshing state... [id=subnet-f23c7194,kubernetes.io/cluster/jobintel-eks][0m
[0m[1maws_ec2_tag.subnet_cluster["subnet-f97176f7"]: Refreshing state... [id=subnet-f97176f7,kubernetes.io/cluster/jobintel-eks][0m
[0m[1maws_ec2_tag.subnet_cluster["subnet-a4b7ff85"]: Refreshing state... [id=subnet-a4b7ff85,kubernetes.io/cluster/jobintel-eks][0m
[0m[1mdata.aws_iam_policy_document.jobintel_s3: Reading...[0m[0m
[0m[1maws_iam_role.eks_cluster: Refreshing state... [id=jobintel-eks-cluster-role][0m
[0m[1maws_iam_role.node: Refreshing state... [id=jobintel-eks-node-role][0m
[0m[1mdata.aws_iam_policy_document.jobintel_s3: Read complete after 0s [id=2460803232][0m
[0m[1maws_iam_policy.jobintel_s3: Refreshing state... [id=arn:aws:iam::048622080012:policy/jobintel-eks-jobintel-s3][0m
[0m[1maws_iam_role_policy_attachment.eks_service_policy: Refreshing state... [id=jobintel-eks-cluster-role-20260204133054223600000004][0m
[0m[1maws_iam_role_policy_attachment.eks_cluster_policy: Refreshing state... [id=jobintel-eks-cluster-role-20260204133054254900000005][0m
[0m[1maws_iam_role_policy_attachment.node_cni: Refreshing state... [id=jobintel-eks-node-role-20260204133054146800000002][0m
[0m[1maws_iam_role_policy_attachment.node_ecr: Refreshing state... [id=jobintel-eks-node-role-20260204133054128300000001][0m
[0m[1maws_iam_role_policy_attachment.node_worker: Refreshing state... [id=jobintel-eks-node-role-20260204133054153000000003][0m
[0m[1maws_eks_cluster.this: Refreshing state... [id=jobintel-eks][0m
[0m[1mdata.aws_eks_cluster.this: Reading...[0m[0m
[0m[1mdata.aws_eks_cluster.this: Read complete after 0s [id=jobintel-eks][0m
[0m[1mdata.tls_certificate.oidc: Reading...[0m[0m
[0m[1mdata.tls_certificate.oidc: Read complete after 1s [id=b1b539daa206035ae3c3e28288b0681fa1b462f3][0m
[0m[1maws_iam_role.jobintel_irsa: Refreshing state... [id=jobintel-eks-jobintel-irsa][0m
[0m[1maws_iam_role_policy_attachment.jobintel_s3: Refreshing state... [id=jobintel-eks-jobintel-irsa-20260204135044421700000002][0m

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m
  [33m~[0m update in-place[0m
 [36m<=[0m read (data resources)[0m

Terraform will perform the following actions:

[1m  # data.aws_iam_policy_document.jobintel_assume[0m will be read during apply
  # (config refers to values not yet known)
[0m [36m<=[0m[0m data "aws_iam_policy_document" "jobintel_assume" {
      [32m+[0m[0m id            = (known after apply)
      [32m+[0m[0m json          = (known after apply)
      [32m+[0m[0m minified_json = (known after apply)

      [32m+[0m[0m statement {
          [32m+[0m[0m actions = [
              [32m+[0m[0m "sts:AssumeRoleWithWebIdentity",
            ]
          [32m+[0m[0m effect  = "Allow"

          [32m+[0m[0m condition {
              [32m+[0m[0m test     = "StringEquals"
              [32m+[0m[0m values   = [
                  [32m+[0m[0m "sts.amazonaws.com",
                ]
              [32m+[0m[0m variable = "oidc.eks.us-east-1.amazonaws.com/id/0F3CE6FA7CA1DB99B557A6107E3D87BC:aud"
            }
          [32m+[0m[0m condition {
              [32m+[0m[0m test     = "StringEquals"
              [32m+[0m[0m values   = [
                  [32m+[0m[0m "system:serviceaccount:jobintel:jobintel",
                ]
              [32m+[0m[0m variable = "oidc.eks.us-east-1.amazonaws.com/id/0F3CE6FA7CA1DB99B557A6107E3D87BC:sub"
            }

          [32m+[0m[0m principals {
              [32m+[0m[0m identifiers = [
                  [32m+[0m[0m (known after apply),
                ]
              [32m+[0m[0m type        = "Federated"
            }
        }
    }

[1m  # aws_eks_node_group.default[0m will be created
[0m  [32m+[0m[0m resource "aws_eks_node_group" "default" {
      [32m+[0m[0m ami_type               = (known after apply)
      [32m+[0m[0m arn                    = (known after apply)
      [32m+[0m[0m capacity_type          = (known after apply)
      [32m+[0m[0m cluster_name           = "jobintel-eks"
      [32m+[0m[0m disk_size              = (known after apply)
      [32m+[0m[0m id                     = (known after apply)
      [32m+[0m[0m instance_types         = [
          [32m+[0m[0m "t3.medium",
        ]
      [32m+[0m[0m node_group_name        = "jobintel-eks-default"
      [32m+[0m[0m node_group_name_prefix = (known after apply)
      [32m+[0m[0m node_role_arn          = "arn:aws:iam::048622080012:role/jobintel-eks-node-role"
      [32m+[0m[0m release_version        = (known after apply)
      [32m+[0m[0m resources              = (known after apply)
      [32m+[0m[0m status                 = (known after apply)
      [32m+[0m[0m subnet_ids             = [
          [32m+[0m[0m "subnet-11001d5c",
          [32m+[0m[0m "subnet-1e470941",
          [32m+[0m[0m "subnet-a4b7ff85",
          [32m+[0m[0m "subnet-f23c7194",
          [32m+[0m[0m "subnet-f97176f7",
        ]
      [32m+[0m[0m tags_all               = (known after apply)
      [32m+[0m[0m version                = (known after apply)

      [32m+[0m[0m scaling_config {
          [32m+[0m[0m desired_size = 1
          [32m+[0m[0m max_size     = 2
          [32m+[0m[0m min_size     = 1
        }
    }

[1m  # aws_iam_openid_connect_provider.this[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_openid_connect_provider" "this" {
      [32m+[0m[0m arn             = (known after apply)
      [32m+[0m[0m client_id_list  = [
          [32m+[0m[0m "sts.amazonaws.com",
        ]
      [32m+[0m[0m id              = (known after apply)
      [32m+[0m[0m tags_all        = (known after apply)
      [32m+[0m[0m thumbprint_list = [
          [32m+[0m[0m "06b25927c42a721631c1efd9431e648fa62e1e39",
        ]
      [32m+[0m[0m url             = "https://oidc.eks.us-east-1.amazonaws.com/id/0F3CE6FA7CA1DB99B557A6107E3D87BC"
    }

[1m  # aws_iam_role.jobintel_irsa[0m will be updated in-place
[0m  [33m~[0m[0m resource "aws_iam_role" "jobintel_irsa" {
      [33m~[0m[0m assume_role_policy    = jsonencode(
            {
              [31m-[0m[0m Statement = [
                  [31m-[0m[0m {
                      [31m-[0m[0m Action    = "sts:AssumeRoleWithWebIdentity"
                      [31m-[0m[0m Condition = {
                          [31m-[0m[0m StringEquals = {
                              [31m-[0m[0m "oidc.eks.us-east-1.amazonaws.com/id/0F3CE6FA7CA1DB99B557A6107E3D87BC:aud" = "sts.amazonaws.com"
                              [31m-[0m[0m "oidc.eks.us-east-1.amazonaws.com/id/0F3CE6FA7CA1DB99B557A6107E3D87BC:sub" = "system:serviceaccount:jobintel:jobintel"
                            }
                        }
                      [31m-[0m[0m Effect    = "Allow"
                      [31m-[0m[0m Principal = {
                          [31m-[0m[0m Federated = "arn:aws:iam::048622080012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/0F3CE6FA7CA1DB99B557A6107E3D87BC"
                        }
                    },
                ]
              [31m-[0m[0m Version   = "2012-10-17"
            }
        ) -> (known after apply)
        id                    = "jobintel-eks-jobintel-irsa"
        name                  = "jobintel-eks-jobintel-irsa"
        tags                  = {}
        [90m# (8 unchanged attributes hidden)[0m[0m

        [90m# (1 unchanged block hidden)[0m[0m
    }

[1mPlan:[0m 2 to add, 1 to change, 0 to destroy.
[0m
Changes to Outputs:
  [33m~[0m[0m oidc_provider_arn         = "arn:aws:iam::048622080012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/0F3CE6FA7CA1DB99B557A6107E3D87BC" -> (known after apply)
[0m[1maws_iam_openid_connect_provider.this: Creating...[0m[0m
[0m[1maws_eks_node_group.default: Creating...[0m[0m
[0m[1maws_iam_openid_connect_provider.this: Creation complete after 0s [id=arn:aws:iam::048622080012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/0F3CE6FA7CA1DB99B557A6107E3D87BC][0m
[0m[1mdata.aws_iam_policy_document.jobintel_assume: Reading...[0m[0m
[0m[1mdata.aws_iam_policy_document.jobintel_assume: Read complete after 0s [id=3390572393][0m
[0m[1maws_eks_node_group.default: Still creating... [10s elapsed][0m[0m
[0m[1maws_eks_node_group.default: Still creating... [20s elapsed][0m[0m
[0m[1maws_eks_node_group.default: Still creating... [30s elapsed][0m[0m
[0m[1maws_eks_node_group.default: Still creating... [40s elapsed][0m[0m
[0m[1maws_eks_node_group.default: Still creating... [50s elapsed][0m[0m
[0m[1maws_eks_node_group.default: Still creating... [1m0s elapsed][0m[0m
[0m[1maws_eks_node_group.default: Still creating... [1m10s elapsed][0m[0m
[0m[1maws_eks_node_group.default: Still creating... [1m20s elapsed][0m[0m
[0m[1maws_eks_node_group.default: Still creating... [1m30s elapsed][0m[0m
[0m[1maws_eks_node_group.default: Still creating... [1m40s elapsed][0m[0m
[0m[1maws_eks_node_group.default: Creation complete after 1m48s [id=jobintel-eks:jobintel-eks-default][0m
[0m[1m[32m
Apply complete! Resources: 2 added, 0 changed, 0 destroyed.
[0m[0m[1m[32m
Outputs:

[0mcluster_name = "jobintel-eks"
cluster_security_group_id = "sg-051448804d30303ed"
jobintel_irsa_role_arn = "arn:aws:iam::048622080012:role/jobintel-eks-jobintel-irsa"
node_role_arn = "arn:aws:iam::048622080012:role/jobintel-eks-node-role"
oidc_provider_arn = "arn:aws:iam::048622080012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/0F3CE6FA7CA1DB99B557A6107E3D87BC"
region = "us-east-1"
serviceaccount_annotation = "eks.amazonaws.com/role-arn=arn:aws:iam::048622080012:role/jobintel-eks-jobintel-irsa"
subnet_ids = tolist([
  "subnet-11001d5c",
  "subnet-1e470941",
  "subnet-a4b7ff85",
  "subnet-f23c7194",
  "subnet-f97176f7",
])
update_kubeconfig_command = "aws eks update-kubeconfig --region us-east-1 --name jobintel-eks"

$ terraform -chdir=ops/aws/infra/eks output -json
{
  "cluster_name": {
    "sensitive": false,
    "type": "string",
    "value": "jobintel-eks"
  },
  "cluster_security_group_id": {
    "sensitive": false,
    "type": "string",
    "value": "sg-051448804d30303ed"
  },
  "jobintel_irsa_role_arn": {
    "sensitive": false,
    "type": "string",
    "value": "arn:aws:iam::048622080012:role/jobintel-eks-jobintel-irsa"
  },
  "node_role_arn": {
    "sensitive": false,
    "type": "string",
    "value": "arn:aws:iam::048622080012:role/jobintel-eks-node-role"
  },
  "oidc_provider_arn": {
    "sensitive": false,
    "type": "string",
    "value": "arn:aws:iam::048622080012:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/0F3CE6FA7CA1DB99B557A6107E3D87BC"
  },
  "region": {
    "sensitive": false,
    "type": "string",
    "value": "us-east-1"
  },
  "serviceaccount_annotation": {
    "sensitive": false,
    "type": "string",
    "value": "eks.amazonaws.com/role-arn=arn:aws:iam::048622080012:role/jobintel-eks-jobintel-irsa"
  },
  "subnet_ids": {
    "sensitive": false,
    "type": [
      "list",
      "string"
    ],
    "value": [
      "subnet-11001d5c",
      "subnet-1e470941",
      "subnet-a4b7ff85",
      "subnet-f23c7194",
      "subnet-f97176f7"
    ]
  },
  "update_kubeconfig_command": {
    "sensitive": false,
    "type": "string",
    "value": "aws eks update-kubeconfig --region us-east-1 --name jobintel-eks"
  }
}
$ terraform -chdir=ops/aws/infra/eks state list
data.aws_eks_cluster.this
data.aws_iam_policy_document.jobintel_assume
data.aws_iam_policy_document.jobintel_s3
data.tls_certificate.oidc
aws_ec2_tag.subnet_cluster["subnet-11001d5c"]
aws_ec2_tag.subnet_cluster["subnet-1e470941"]
aws_ec2_tag.subnet_cluster["subnet-a4b7ff85"]
aws_ec2_tag.subnet_cluster["subnet-f23c7194"]
aws_ec2_tag.subnet_cluster["subnet-f97176f7"]
aws_eks_cluster.this
aws_eks_node_group.default
aws_iam_openid_connect_provider.this
aws_iam_policy.jobintel_s3
aws_iam_role.eks_cluster
aws_iam_role.jobintel_irsa
aws_iam_role.node
aws_iam_role_policy_attachment.eks_cluster_policy
aws_iam_role_policy_attachment.eks_service_policy
aws_iam_role_policy_attachment.jobintel_s3
aws_iam_role_policy_attachment.node_cni
aws_iam_role_policy_attachment.node_ecr
aws_iam_role_policy_attachment.node_worker
